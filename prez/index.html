<!doctype html>
<html lang="no">
<head>
  <meta charset="utf8">
  <title>JavaScript - Mesaninen 2014</title>
  <link rel="stylesheet" href="../revealjs/css/reveal.min.css">
  <link rel="stylesheet" href="../revealjs/css/theme/sky.css" id="theme">
  <link rel="stylesheet" href="../highlight/styles/default.css">
</head>
<html><body>
  <div class="reveal">
    <div class="slides">

      <section>
        <h1>JavaScript</h1>
        <p>Mesaninen 2014</p>
        <p>Arild Tvergrov &amp; Mikkel Steine</p>
      </section>

      <section>
        <h2>Program</h2>
        <ol>
          <li>Hvorfor JavaScript?</li>
          <li>Historikk</li>
          <li>Bruksområder</li>
          <li>Språket JavaScript</li>
          <li>Fremtiden</li>
          <li>Rammeverk</li>
          <li>Bygging</li>
          <li>Testing</li>
          <li>Lære mer...</li>
        </ol>
      </section>

      <section class="stack">
        <section>
          <h2>Hvorfor JavaScript?</h2>
          <p>(Alle bruker det.)</p>
        </section>

        <section>
          <h3>Suksesshistorier</h3>
          <ul>
            <li>Norman Antivirus</li>
            <li>KISS</li>
            <li></li>
          </ul>
        </section>
      </section>

      <section class="stack">
        <section>
          <h2>Historikk</h2>
        </section>
        <section>
          <h2>JavaScript blir til...</h2>
          <ul>
            <li>1996 mar: Introdusert i Netscape Navigator 2.0, laget for å slippe lange rundturer til server.</li>
            <li>1997 okt: Dynamisk HTML kom i IE4.</li>
            <li>1999/2000: DOM kom med IE5, NS6 og Opera.</li>
            <li>1999 des: Standarden <em>ECMAScript</em>, utgv. 3.</li>
          </ul>
        </section>

        <section>
          <h2>Treg utvikling...</h2>
          <ul>
            <li>2000-tallet: JS-motorene henger ikke med i svingene</li>
            <li>IE6 legger hemsko på utviklerne</li>
            <li>Intrepretert språk - tregt</li>
          </ul>
        </section>

        <section>
          <h2>Renessanse</h2>
          <ul>
            <li>2008: Google Chrome med V8: JS-motor med JIT-compiler</li>
            <li>Andre fulgte etter:<ul>
              <li>Safari 4: SquirrelFish Extreme</li>
              <li>FireFox 3.5: TraceMonkey</li>
              <li>IE 9: Chakra</li>
            </ul></li>
            <li>JavaScript fikk et skikkelig ytelsesløft!</li>
          </ul>
        </section>

        <section>
          <h2>Implementér!</h2>
          <ul>
            <li>Det offisielle navnet på standarden er ECMAScript</li>
            <li>Siste versjon er 1.8.5</li>
            <li>Mange forskjellige implementasjoner av ES
              <ul>
                <li>JavaScript 1.8.5 (ES5+, Firefox)</li>
                <li>JScript 9.0 (ES5, Microsoft)</li>
                <li>Nashorn 1.8.0 (ES5.1, Java/Oracle)</li>
                <li>ActionScript (ES3, Flash og Flex)</li>
                <li>QtScript (ES3, Qt)</li>
                <li>ExtendScript (ES3, Adobe CS)</li>
                <li>... og mange flere</li>
              </ul>
            </li>
            <li>Alle implementasjoner har særegenheter i forhold til standarden.</li>
          </ul>
        </section>
      </section>

      <section class="stack">
        <section>
          <h2>Bruksområder</h2>
        </section>
      </section>

      <section class="stack">
        <section>
          <h2>Språket Javascript</h2>
          <ul>
            <li>Elementært</li>
            <li>Datatyper</li>
            <li>Falsy og truthy</li>
            <li>Scope</li>
            <li>Math</li>
            <li>String</li>
            <li>DOM</li>
            <li>Eventer</li>
            <li>Serverkommunikasjon</li>
            <li>Prototyper</li>
            <li>Ytelse</li>
          </ul>
        </section>
        <section>
          <h2>Elementært</h2>
          <ul>
            <li>Imperativt og strukturert: if, while, for, etc. C-stil.</li>
            <li>Dynamisk: Type følger verdi, ikke variabel. "Alt" er objekter og kan utvides som man vil.</li>
            <li>Funksjonelt: Funksjoner er også objekter. Funksjoner kan nøstes også.</li>
            <li>Prototype-basert: Bruker prototyper (altså gjenbruk av eksisterende objekt) i stedet for klasser og arv.</li>
          </ul>
        </section>
        <section>
          <pre><code data-trim contenteditable class="hljs javascript">var kurs = 5.67;
var f = function(x) { return x * kurs; };

function ytreFunksjon() {
  function indreFunksjon() {
    alert("Hei!");
  }
  indreFunksjon();
}
</code></pre>
        </section>

        <section>
          <h2>Prototyper</h2>
<pre><code data-trim contenteditable class="hljs javascript">function Ansatt(navn, tittel, fodt) {
  this.navn = navn;
  this.tittel = tittel;
  this.fodt = fodt;
}

var fred = new Ansatt("Fred Flintstone", "Caveman", 1970);
Ansatt.prototype.salary = null;
Ansatt.salary = 20000;
</code></pre>
        </section>
        <section>
          <h2>Datatyper</h2>
          <ul>
            <li>JavaScript er svakt typet</li>
            <li>Operasjoner på typer i JS er ikke helt som man forventer</li>
            <li>Alt er objekter, så konvertering av type betyr oppretting av nytt objekt og konvertering av verdi</li>
            <li>Ikke opprett primitiver med "new". Ting blir mer komplekst og tregere.
            <li>De forskjellige typene er: String, Number, Boolean, Array, Object, Undefined, null.</li>
            <li>Bruk typeof for å sjekke typen av verdien.</li>
          </ul>
          <pre><code data-trim contenteditable class="hljs javascript">
var x; // undefined
x = 10; // number
x = "Bøtteknott"; // string
x = typeof x; // "string"
          </code></pre>
        </section>
        <section>
          <h2>Number</h2>
          <ul>
            <li>Alle tall i JS representeres med denne typen.</li>
            <li>Integer finnes ikke!! Number implememteres med en double.</li>
            <li>Man kan skrive tall med eller uten desimaler: 34.00 == 34</li>
            <li>Man kan bruke vitenskapsnotasjon: 1e2 == 100; 1e-2 == 0.01</li>
            <li>Tall oppfører seg som en double i C/Java med de utfordringer det medfører.</li>
            <li>Bruk &lt; og &gt; i stedet for = og != når man sammenligner tall, siden man ikke har nøyaktige desimaltall.</li>
            <li>Tall blir automatisk konvertert til og fra andre typer om man prøver å bruke dem.</li>
            <li>Om JS ikke klarer å konvertere en type til et tall så blir verdien <em>NaN</em> (Not a Number).</li>
          </ul>
        </section>
        <section>
          <pre><code data-trim contenteditable class="hljs javascript">
x = 10 + "5"; // ?
x = "5" + 10; // ?
x = "10" - 5; // ?
x = 5 + "e4"; // ?
x = "4r" - 3; // ?
x = parseInt("4r") - 3; // ?
x = parseInt("a3") - 3; // ?
x = 1.000001 + 1; // ?
x = 1.000001 - 1; // ?
0.1.toFixed(20); // 0.10000000000000000555
x = 9999999999999999; // ?

function isNumeric(n) {
  return !isNaN(parseFloat(n)) &amp;&amp; isFinite(n)
}
          </code></pre>
        </section>
        <section>
          <h2>Boolean</h2>
          <p>(Falsy og thruthy)</p>
          <ul>
            <li>Følgende verdier er falsy: false, 0, "", null, undefined, NaN</li>
            <li>ALT annet er truthy!</li>
            <li>Bruk ===, !==, &gt;==, &lt;== i stedet for ==, !=, &gt;=, &lt;= til alle sjekker. == konverterer, === gjør det ikke.</li>
            <li>Man må ikke bruke new Boolean(), da denne alltid er true(thy).</li>
          </ul>
        </section>
        <section>
          <pre><code data-trim contenteditable class="hljs javascript">var c = (false == 0); // true
var d = (false == ""); // true
var e = (0 == ""); // true
var f = (null == false); // false
var g = (null == null); // true
var h = (undefined == undefined); // true
var i = (undefined == null); // true
var j = (NaN == null); // false
var k = (NaN == NaN); // false
var l = (false == 0); // true
var m = (false === 0); // false

var x = true - 1; // ?
x = new Boolean(false);
if (x) {
  // Kommer vi hit?
}
          </code></pre>
        </section>
        <section>
          <h2>String</h2>
          <ul>
            <li>Kan bruke både ' eller ", f.eks. om man har en streng med et av disse tegnene i seg, så kan man bruke det andre tegnet.</li>
            <li>"Backslash" (\) brukes for å escape et spesialtegn.</li>
            <li>Ikke bruk new String, som gir mange uheldig bieffekter. Lag vanlige strengprimitiver.</li>
            <li>En streng har masse attributter og funksjoner, f.eks. <code>"abc".length => 3</code> og <code>" abc ".trim() => "abc"</code></li>
          </ul>
          <pre><code data-trim contenteditable class="hljs javascript">
x = "abc"
x = x.substr(0,2); // "ab"
          </code></pre>
        </section>
        <section>
          <h2>Object</h2>
          <ul>
            <li>Alt bortsett fra primitivene i JS er objekter, også funksjoner.</li>
            <li>Man lager et objekt ganske enkelt med <code>var obj = { bedrift : "Mesan", adressse : "HI20" };</code></li>
            <li>Du legger enkelt til nye verdier med <code>obj.telefonnr = "22334455";</code></li>
            <li>Denne oppførselen er felles for alle objekter, selv om Array er litt spesiell...</li>
            <li>Å legge til en funksjon til et objekt er like enkelt som å legge til verdier.</li>
          </ul>
          <pre><code data-trim contenteditable class="hljs javascript">
var bedrift = { navn : "Mesan AS", adresse : "HI20", telefonnr : "22334455" };
bedrift.ring = function() { alert(this.telefonnr); }
          </code></pre>
        </section>
        <section>
          <h2>Array</h2>
          <ul>
            <li>Et spesielt objekt med litt anderledes aksessering; man bruker <code>[]</code> i stedet for .</li>
            <li><code>new Array(1,2,3) === [1,2,3]</code></li>
            <li>Alle elementene i en array kan ha forksjellige typer.</li>
            <li>Første element starter på 0, som i C/Java: <code>([1,2,3])[0] === 1;</code></li>
            <li><code>typeof [1,2,3] == "object"</code></li>
          </ul>
        </section>
        <section>
          <h2>Inifinity, Undefined og null</h2>
          <ul>
            <li>En variabel er undefined når den ikke har fått noen verdi.</li>
            <li>En variabel er null når man setter den til null.</li>
            <li>Disse to er altså ikke det samme, og en verdi som ikke er satt blir ikke automatisk null.</li>
            <li>Inifinity er verdien som vises om tallet overskrider maks verdi (positivt eller negativt).</li>
          </ul>
        </section>

        <section>
          <h2>Scope</h2>
          <ul>
            <li>Et veldig viktig konsept!</li>
            <li>Alle funksjoner har sitt eget scope, som betyr at alt som opprettes i scopet til en funksjon er bare tilgjengelig i det scopet.</li>
            <li>Variable man ikke oppretter med var foran blir globale (en del av Window).</li>
            <li>Alle variable/funksjoner man kaller som ikke er en del av scopet må letes fram i scope-rekka.</li>
          </ul>
          <pre><code data-trim contenteditable class="hljs javascript">
function f() {
  x = 10; // window.x opprettes/oppdateres
  var y = 20; // opprettes i lokalt scope til f(), ikke tilgjengelig utenfra
  function visKoordinat() {
    var z = 30;
    alert("hei " + x + "," + y + "," + z);
  }
  visKoordinat();
}
          </code></pre>
        </section>
        <section>
          <h2>Math</h2>
          <ul>
            <li><code>Math</code> og <code>Date</code> er implementert i C++ og er så kjappe som det går. Ikke prøv å erstatte noen av funksjonene i disse med egen JS-kode.</li>
            <li><code>Math</code> inneholder de vanligste mattefunksjonene og noen predefinerte konstanter.</li>
            <li>Tall kan skrives på forskjellige formater: <code>10 == 0x10 == 012</code>, men man har ikke tilsvarende for binære tall (må bruke streng og <code>parseInt("1010",2)</code>).</li>
            <li>Også bit-mønster-operatorer er effektive: &amp;, |, ~, ^, &lt;&lt; og &gt;&gt;</li>
          </ul>
        </section>
        <section>
          <h2>Date</h2>
          <ul>
            <li>I <code>Date</code>-objektet finner man mange nyttige funksjoner for dato og tid.</li>
            <li>Man kan sammenligne to <code>Date</code>-objekter.</li>
          </ul>
        </section>
        <section>
          <h2>RegExp</h2>
          <ul>
            <li>Man kan lage <code>RegExp</code>-objekter med new, men det er ikke nødvendig. Bruk heller <i>/mønster/modifikatorer</i></li>
            <li>Bruker du samme mønster mange ganger, kan du lagre den i en variabel og bruke f.eks. exec på den.</li>
          </ul>
          <pre><code data-trim contenteditable class="hljs javascript">
var pattern = /^[A-Z]$/i;
var res = str.replace(/(gutt|jente)/i, "menneskebarn");
var t = /du/i.exec("Du er der."); // 'Du'
if (str.match(pattern).length > 0) { /* strengen matcher mønsteret */ }
          </code></pre>
        </section>
        <section>
          <h2>DOM</h2>
          <ul>
            <li>Document Object Model holder alle elementene i en webside i et tre i minnet.</li>
            <li>Du har direkte tilgang til denne med <code>document</code>.</li>
            <li>Med <code>document.getElementById("minId")</code>, <code>getElementsByClassName</code> eller <code>getElementsByName</code> kan man finne elementer i DOM.</li>
            <li>Traversering av DOM er kostbart og bør gjøres med forsiktighet. Mellomlagre ting du vil bruke mer enn en gang.</li>
          </ul>
        </section>
        <section>
          <h2>Eventer</h2>
          <ul>
            <li>Den måten folk flest begynner å sette opp eventer på er å legge de til i HTML. F.eks. <code>&lt;a href="#" onclick="doSomething()"&gt;</code> </li>
            <li>En ryddigere måte er å bruke <code>element.addEventListener("click", function(){ ... })</code> direkte på DOM-objektet.</li>
            <li>IE er selvfølgelig vanskelig og der heter funksjonen i v8 og eldre <code>attachEvent</code>.</li>
            <li>Man kan legge til event-lyttere til alle DOM-objekter, også <code>window</code> og man kan legge til flere til hvert element.</li>
            <li>Man kan også fjerne og fyre av eventer (dispatchEvent og removeEventListener).</li>
          </ul>
        </section>
        <section>
          <pre><code data-trim contenteditable class="hljs javascript">
var useCapture = false; // Indre element håndteres først, true gjør motsatt
var myFunction = function(event) {
  var element = this; // elementet du klikket på
  var faktiskElement = event.currentTarget;
}, useCapture);

var x = document.getElementById("myBtn");
if (x.addEventListener) { // Alle nettlesere bortsett fra IE8 og eldre
    x.addEventListener("click", myFunction, useCapture);
} else if (x.attachEvent) { // IE8 og eldre
    x.attachEvent("onclick", myFunction, useCapture);
}

x.removeEventListener("click", myFunction);
          </code></pre>
        </section>
        <section>
          <h2>Globale funksjoner</h2>
          <ul>
            <li>JavaScript har noen få støttefunksjoner. Et par av dem er verdt å nevne:</li>
            <li><code>eval()</code> er en funksjon som tar input gjennom JS-parseren og kjører innholdet. eval is evil!</li>
            <li><code>encodeURI()</code>, <code>decodeURI()</code> brukes får å sikre at en URL er godkjent og at alle spesialtegn er håndtert. Rører ikke spesialtegn som er en del av fullverdig URL.</li>
            <li><code>encodeURIComponent()</code>, <code>decodeURIComponent()</code> gjør tilsvarende, men erstatter også alle tegn i en gyldig URL.</li>
            <li><code>parseInt()</code> og <code>parserFloat()</code> gjør akkurat det, men trengs aldri i praksis. <code>parseInt</code> har en bonus ved at den med ekstra parameter kan gi tallene i hex eller andre tallsystemer.</li>
          </ul>
        </section>
      </section>

      <section class="stack">
        <section>
          <h2>jQuery</h2>
          <ul>
            <li>Skjuler forskjeller mellom implementasjoner. "Alle" bruker det.</li>
            <li>"Unobtrusive"</li>
            <li>Hovedbruksområder:<ul>
              <li>Henting/manipulering av elementer</li>
              <li>Hendelser</li>
              <li>Animasjoner</li>
              <li>AJAX</li>
            </ul>
          </ul>
        </section>
        <section>
          <h2>Selectors</h2>
          <ul>
            <li>Programmerervennlig måte å finne elementer i DOM: <code>$(".knapp")</code></li>
            <li>Bygger på CSS-selectors: <code>.class, #id, div</code></li>
            <li>Mer avansert utvalg med f.eks.: <code>:first, :last, :gt(), :lt(), :even, :odd</code></li>
            <li>Velg elementer basert på innhold: <code>:containts(), :has(), :empty()</code></li>
            <li>Velg elementer basert på verdi/attributter: <code>[navn="verdi"]</code></li>
            <li>+++</li>
            <li>Resultatet er et objekt som inneholder en Array med DOM-elementer</li>
          </ul>
        </section>
        <section>
          <h2>Manipulering</h2>
          <ul>
            <li>jQuery har endel nyttige funksjoner for manipulering av DOM-elementer.</li>
            <li></li>
          </ul>
        </section>
      </section>

      <section class="stack">
        <section>
          <h1>Fremtiden</h1>
        </section>

        <section>
          <h2>EcmaScript 6<br />(&laquo;ES.next&raquo;)</h2>
        </section>

        <section>
          <h2>Når kommer ES6?</h2>
          <p>Ratifiseres i desember 2014.</p>
          <p>Implementeres fortløpende i moderne nettlesere.</p>
        </section>

        <section>
          <h2>Hva blir (er?) nytt?</h2>
          <ul>
            <li>Block Scope</li>
            <li>Klasser</li>
            <li>Arrows</li>
            <li>Promises</li>
            <li>Moduler</li>
            <li>Generators</li>
            <li>++</li>
          </ul>
        </section>

        <section>
          <h2>Block Scope</h2>
          ES5 har global og function scope, men ikke block scope:<br />
<pre><code data-trim class="hljs javascript">if (true) {
  var a = 'abc';
}

a; // &lt;= 'abc'
</code></pre>
        </section>

        <section>
          <h2>Block Scope</h2>
          ES6 har block scope med nøkkelordet <code>let</code>:<br />
<pre><code data-trim class="hljs javascript">if (true) {
  var a = 'abc';
  let b = 'def';
}

a; // &lt;= 'abc'
b; // &lt;= undefined
</code></pre>
        </section>

        <section>
          <h2>Klasser</h2>
          ES5:<br />
<pre><code data-trim class="hljs javascript">function Vehicle(owner) {
  this.owner = owner;
}

Vehicle.prototype.printOwner = function () {
  console.log('The owner of this vehicle is ' + this.owner);
};

var myVehicle = new Vehicle('Arild');
</code></pre>
        </section>

        <section>
          <h2>Klasser</h2>
          ES6:<br />
<pre><code data-trim class="hljs javascript">class Vehicle {
  constructor(owner) {
    this.owner = owner;
  }

  printOwner() {
    console.log('The owner of this vehicle is ' + this.owner);
  }
}

let myVehicle = new Vehicle("Arild");
</code></pre>
        </section>

        <section>
          <h2>Klasser og arv</h2>
          ES6:<br />
<pre><code data-trim class="hljs javascript">class Vehicle {
  constructor(owner, canFly) {
    this.owner = owner;
    this.canFly = canFly;
  }

  printOwner() { /* ... */ }
}

class Plane extends Vehicle {
  constructor(owner) {
    super(owner, true);
  }
}

let myPlane = new Plane("Arild");
myPlane.canFly; // <= true
</code></pre>
        </section>

        <section>
          <h2>Arrows</h2>
          Hva ES6 løser:<br />
<pre><code data-trim class="hljs javascript">var nr = [0, 1, 2];

var squareNr = nr.map(function (x) {
  return x * x;
});

console.log(squareNr);
</code></pre>
        </section>

        <section>
          <h2>Arrows</h2>
          ES6 løser det slik:<br />
<pre><code data-trim class="hljs javascript">let nr = [0, 1, 2];

let squareNr = nr.map(x => x * x);
</code></pre>
        </section>

        <section>
          <h2>Promises</h2>
          <p>ES5: Callbacks From Hell</p>
<pre><code data-trim class="hljs javascript">doThis(function () {
  doThat(function () {
    pleaseDoThisToo(function () {
      andEventuallyDoThisAsWell(function () {
        ohAndAlmostForgot(function () {
          console.log('Done!');
        });
      });
    });
  });
});
</code></pre>
          <p>Tredjepartsbiblioteker gir god Promise-støtte:<br />
            Q.js, jQuery, RSVP.js, ++</p>
        </section>

        <section>
          <h2>Promises</h2>
          <p>ES6: Innebygd støtte for promises</p>
        </section>

        <section>
          <h2>Promises</h2>
          <h3><code>Promise.all()</code></h3>
<pre><code data-trim class="hljs javascript">let p1 = new Promise((resolve, reject) =>
  setTimeout(resolve, 300, 'done!'));

let p2 = new Promise((resolve, reject) =>
  setTimeout(resolve, 400, 'meToo!'));

Promise.all([p1, p2]).then((value) => console.log(value));
// &lt;= ['done!', 'meToo!']
</code></pre>
        </section>

        <section>
          <h2>Promises</h2>
          <h3><code>Promise.race()</code></h3>
<pre><code data-trim class="hljs javascript">let p1 = new Promise((resolve, reject) =>
  setTimeout(resolve, 400, 'rabbit'));

let p2 = new Promise((resolve, reject) =>
  setTimeout(resolve, 200, 'turtle'));

Promise.race([p1, p2]).then((value) => console.log(value)); // &lt;= 'turtle'
</code></pre>
        </section>

        <section>
          <h2>Generators</h2>
<pre><code data-trim class="hljs javascript">function *characters(name) {
  let i = 0;
  while (true) {
    if (i >= name.length) i = 0;
    yield name[i++];
  }
}

let chars = characters('Arild');

for (let i = 0; i < 10; i++) {
  console.log(chars.next().value);
}
</code></pre>

        </section>

        <section>
          <h2>++</h2>
          <p class="fragment current-visible">
            Standard-parametre:<br /><code>function (a, b=1, c=2) {}</code>
          </p>
          <p class="fragment current-visible">
            Rest-parametre:<br /><code>function format(str, ...args) {}</code>
          </p>
          <p class="fragment current-visible">
            Destructured Assignment:<br /><code>let [one, two] = [1, 2];</code>
          </p>
          <p class="fragment current-visible">
            Template Strings:<br /><code>`Hello ${name}, how are you ${time}?`</code>
          </p>
          <p class="fragment current-visible">
            <code>For-of</code>-løkker:<br /><code>for (let nr of [1, 2, 3]) {}</code>
          </p>

        </section>

      </section>

      <section class="stack">
        <section>
          <h1>Rammeverk</h1>
        </section>

        <section data-background="tagcloud.png" data-background-transition="zoom">

        </section>
      </section>

      <section class="stack">
        <section>
          <h1>Bygging</h1>
        </section>
      </section>

      <section class="stack">
        <section>
          <h1>Testing</h1>
        </section>
      </section>

    </div>
  </div>

  <script src="../revealjs/lib/js/head.min.js"></script>
  <script src="../revealjs/js/reveal.min.js"></script>
  <script src="../highlight/highlight.pack.js"></script>
  <script>
    Reveal.initialize({
      controls: true,
      parallaxBackgroundImage:
        "parallax2.jpg",
      parallaxBackgroundSize: '1920px 1920px',
      transition: 'linear'
    });
    hljs.initHighlightingOnLoad();
  </script>
</body></html>